[
  {
    "objectID": "about_me.html",
    "href": "about_me.html",
    "title": "About Me",
    "section": "",
    "text": "BackgroundEducationHighlighted Projects\n\n\n\nProfessional Bio\n\n\n\n\nEducation\n\nBren School of Environmental Science & Management, UCSB Graduation Cap Masters in Environmental Data Science | Graduated: June 2023 \nUniversity of California - Santa Barbara (UCSB) Graduation Cap BA Environmental Studies | Graduated: June 2021\nSanta Monica College Graduation Cap AS Economics & Accounting | Graduated: June 2018\n\n\n\nHighlighted Projects\n\nMaster’s Environmental Data Science Capstone Project | 2023  Title: Assessing Wildfire in Groundwater Dependent Ecosystems Role: Project & Data Manager  Reproducible Code: Analysis, Dashboard Video\nDescription: We developed a ShinyApp Dashboard in R to show wildfire statistics and trends within groundwater dependent ecosystems (GDEs) in California. The final product is a single operating platform where you can click on any groundwater dependent ecosystem in California and view wildfire statistics for that particular ecosystem."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Andre Dextre",
    "section": "",
    "text": "BackgroundEducationHighlighted Projects\n\n\n\nBiography\n\nHello! I’m Andre, an Environmental Data Scientist with a deep-rooted passion for advancing sustainable water management. Born and raised in Lima, Peru, I experienced firsthand the challenges of water scarcity due to inadequate infrastructure and prolonged droughts. In 2006, at the age of eight, my family and I immigrated to the United States, a journey that shaped my worldview and my career path.\nThe challenges I experienced with water scarcity while growing up in Lima ignited a profound dedication to addressing global water issues. This led me to earning my Master’s degree in Environmental Data Science from the Bren School of Environmental Science and Management at UC Santa Barbara. Throughout my academic journey, I’ve gained skills in water analysis, hydrological modeling, and scientific communication, equipping me with the tools to make a difference in the world of water policy and management.\nI am driven by the belief that effective water management is pivotal for community well-being and environmental sustainability. My goal is to leverage my academic background in water resources management and data science to inform and improve water policy, ensuring that communities worldwide have access to reliable and clean water.\n\n\n\nEducation\n\nBren School of Environmental Science & Management, UCSB Graduation Cap Masters in Environmental Data Science | Graduated: June 2023 \nUniversity of California - Santa Barbara (UCSB) Graduation Cap BA Environmental Studies | Graduated: June 2021\nSanta Monica College Graduation Cap AS Economics & Accounting | Graduated: June 2018\n\n\n\nHighlighted Projects\n\nMaster’s Environmental Data Science Capstone Project | 2023  Title: Assessing Wildfire in Groundwater Dependent Ecosystems Role: Project & Data Manager  Reproducible Code: Analysis, Dashboard Video\nDescription: We developed a ShinyApp Dashboard in R to show wildfire statistics and trends within groundwater dependent ecosystems (GDEs) in California. The final product is a single operating platform where you can click on any groundwater dependent ecosystem in California and view wildfire statistics for that particular ecosystem.\nWater Data Research Project | 2021 Title: US Irrigation Methods & Water Withdrawals (Mgal/d) Role: Student Researcher  Reproducible Code: Analysis, Interactive Map\n\n\n\n\n\n\nData Source: United States Geological Survey (2015)"
  },
  {
    "objectID": "my_blogs.html",
    "href": "my_blogs.html",
    "title": "Gallery",
    "section": "",
    "text": "United States’ Water-Use Data Portfolio (1950-2015)\n\n\n\nMEDS\n\n\nR\n\n\nWater\n\n\n\nA closer look into the United States’ freshwater withdrwals from surface and groundwater sources, as well as the country’s water-use per demand sector for years 1950-2015\n\n\n\nAndre Dextre\n\n\nDec 9, 2022\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/water_use/index.html",
    "href": "posts/water_use/index.html",
    "title": "United States’ Water-Use Data Portfolio (1950-2015)",
    "section": "",
    "text": "The data in this portfolio is available from the United States Geological Survey for years 1950-2015.\n\nLoad Libraries\n\n\nView Code\nknitr::opts_chunk$set(echo = TRUE)\nlibrary(tidyverse)\nlibrary(here)\nlibrary(janitor)\nlibrary(readxl)\nlibrary(sf)\nlibrary(USAboundaries)\nlibrary(scales)\nlibrary(ggthemes)\nlibrary(gghighlight)\nlibrary(ggnewscale)\n\n\n\n\nLoad Data\n\n\nView Code\n#Read 1950 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1950 <- lapply(excel_sheets(here(\"data/water_use/us1950.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1950.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:9), as.numeric)) %>%\n  select(-contains(\"note_\")) %>%\n  replace(is.na(.), 0)\n#Read 1955 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1955 <- lapply(excel_sheets(here(\"data/water_use/us1955.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1955.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:10), as.numeric)) %>%\n  select(-contains(\"note_\")) %>%\n  replace(is.na(.), 0)\n#Read 1960 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1960 <- lapply(excel_sheets(here(\"data/water_use/us1960.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1960.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:35), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1965 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1965 <- lapply(excel_sheets(here(\"data/water_use/us1965.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1965.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:33), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1970 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1970 <- lapply(excel_sheets(here(\"data/water_use/us1970.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1970.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:34), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1975 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1975 <- lapply(excel_sheets(here(\"data/water_use/us1975.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1975.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:34), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1980 data,skip rows, read sheets and join, clean names, turn to numeric,\n#and filter out NA\nd_wu_1980 <- lapply(excel_sheets(here(\"data/water_use/us1980.xlsx\")),\n                    function(x) read_excel(here(\"data/water_use/us1980.xlsx\"), skip = 3, sheet = x)) %>%\n  reduce(left_join, by = \"Area\") %>%\n  clean_names() %>%\n  mutate(across(c(1:34), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1985 data, clean names, turn to numeric, and filter out NA\nd_wu_1985 <- read_tsv(here(\"data/water_use/us1985.txt\")) %>%\n  clean_names() %>%\n  mutate(across(c(4:163), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1990 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_1990 <- read_xls(here(\"data/water_use/us1990.xls\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate(across(c(4:163), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 1995 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_1995 <- read_xls(here(\"data/water_use/us1995.xls\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate_at((1), as.numeric) %>%\n  mutate(across(c(3:4), as.numeric)) %>%\n  mutate(across(c(6:252), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2000 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2000 <- read_xls(here(\"data/water_use/us2000.xls\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate(across(c(2:70), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2005 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2005 <- read_xls(here(\"data/water_use/us2005.xls\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate(across(c(2:4), as.numeric)) %>%\n  mutate(across(c(6:108), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2010 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2010 <- read_xlsx(here(\"data/water_use/us2010.xlsx\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate_at((2), as.numeric) %>%\n  mutate(across(c(4:117), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2015 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2015 <- read_xlsx(here(\"data/water_use/us2015.xlsx\"), skip = 1) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate_at((2), as.numeric) %>%\n  mutate(across(c(4:141), as.numeric)) %>%\n  replace(is.na(.), 0)\n\n\n\n\nOrganize Data by Sector and FIPS (Federal Information Standards)\n\n\nView Code\n#Assign d_wu_year to wu_year\n#Create new columns (State, Public Supply, Irrigation, Rural, Industrial,\n#Thermoelectric, and Year)\n#Pivot longer to create \"Sectors\" and \"Withdrawals\" column \n\n#1950\nwu_1950 <- d_wu_1950 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = NA,\n         Industrial = inpt_wgw_fr + inpt_wsw_fr,\n         Thermoelectric = NA,\n         Year = 1950) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1955\nwu_1955 <- d_wu_1955 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = NA,\n         Industrial = inpt_wgw_fr + inpt_wsw_fr,\n         Thermoelectric = NA,\n         Year = 1955) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1960\n#Replace ir_wsw_fr and ir_wgw_fr with ir_w_fr_to (The two columns do not have any data)\nwu_1960 <- d_wu_1960 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_w_fr_to,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = oi_wgw_fr + oi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1960) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1965\nwu_1965 <- d_wu_1965 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = oi_wgw_fr + oi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1965) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")  \n\n#1970\nwu_1970 <- d_wu_1970 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = oi_wgw_fr + oi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1970) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n\n#1975\nwu_1975 <- d_wu_1975 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = oi_wgw_fr + oi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1975) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1980\nwu_1980 <- d_wu_1980 %>%\n  mutate(State = area,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = oi_wgw_fr + oi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1980) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")   \n\n#From 1985 and on add the following:\n#Group by state\n#Add across columns 1:5\n#Add \"Year\" column\n\n#1985\nwu_1985 <- d_wu_1985 %>%\n  mutate(State = scode,\n         \"Public Supply\" = ps_wgwfr + ps_wswfr,\n         Irrigation = ir_wgwfr + ir_wswfr,\n         Rural = do_ssgwf + do_ssswf + ls_gwtot + ls_swtot,\n         Industrial = in_wgwfr + in_wswfr + mi_wgwfr + mi_wswfr,\n         Thermoelectric = pt_wgwfr + pt_wswfr,\n         Year = 1985) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 1985) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1990\nwu_1990 <- d_wu_1990 %>%\n  mutate(State = scode,\n         \"Public Supply\" = ps_wgwfr + ps_wswfr,\n         Irrigation = ir_wgwfr + ir_wswfr,\n         Rural = do_ssgwf + do_ssswf + ls_gwtot + ls_swtot,\n         Industrial = in_wgwfr + in_wswfr + mi_wgwfr + mi_wswfr,\n         Thermoelectric = pt_wgwfr + pt_wswfr,\n         Year = 1990) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 1990) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#1995\nwu_1995 <- d_wu_1995 %>%\n  mutate(State = state_code,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = in_wgw_fr + in_wsw_fr + mi_wgw_fr + mi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 1995) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 1995) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#2000\nwu_2000 <- d_wu_2000 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr, Irrigation = it_wgw_fr + it_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = in_wgw_fr + in_wsw_fr + mi_wgw_fr + mi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 2000) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2000) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n\n#2005\nwu_2005 <- d_wu_2005 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + ls_wgw_fr + ls_wsw_fr,\n         Industrial = in_wgw_fr + in_wsw_fr + mi_wgw_fr + mi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 2005) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2005) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#2010\nwu_2010 <- d_wu_2010 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + li_wgw_fr + li_wsw_fr,\n         Industrial = in_wgw_fr + in_wsw_fr + mi_wgw_fr + mi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 2010) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2010) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\") \n\n#2015\nwu_2015 <- d_wu_2015 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr + ps_wsw_fr,\n         Irrigation = ir_wgw_fr + ir_wsw_fr,\n         Rural = do_wgw_fr + do_wsw_fr + li_wgw_fr + li_wsw_fr,\n         Industrial = in_wgw_fr + in_wsw_fr + mi_wgw_fr + mi_wsw_fr,\n         Thermoelectric = pt_wgw_fr + pt_wsw_fr,\n         Year = 2015) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2015) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n\n\n\n\nU.S. Total Freshwater Withdrawals (1950-1950)\n\n\nView Code\n#Combine all 14 objects into wu_all\n#Remove unnecessary FIPS\nwu_all <- rbind(wu_1950, wu_1955, wu_1960, wu_1965, wu_1970, wu_1975, wu_1980, wu_1985,\n                wu_1990, wu_1995, wu_2000, wu_2005, wu_2010, wu_2015) %>%\n  filter(State != \"78\",\n         State != \"72\",\n         State != \"69\",\n         State != \"66\",\n         State != \"60\",\n         State != \"0\",\n         State != \"11\")\n\n#Call wu_all to a plot object\n#Remove \"Sectors\" column\n#Replace \"NA\" with \"0\"\n#Group by \"Year\"\n#Sum \"Withdrawals\" to gain total withdrawals by year\nwu_all_plot <- wu_all %>%\n  select(-Sectors) %>%\n  replace(is.na(.), 0) %>%\n  group_by(Year) %>%\n  summarize(across(Withdrawals, sum))\n\n#Create a plot\nggplot() +\n  \n  geom_line(data = wu_all_plot, \n            aes(x = Year,\n                y = Withdrawals),\n            color = \"dodgerblue\", size = 2) +\n  #geom_label adds labels to the plot that we are making\n  geom_label(data = wu_all_plot,\n             aes(x = Year,\n                 y = Withdrawals,\n                 #Adds label on data points with commas on the plot for Withdrawals\n                 #for up to 3 significant figures\n                 #Adjusts size for label text to 1.5\n                 label = scales::comma(signif(Withdrawals, 3))),\n             size = 1.5) +\n  labs(x = \"Year\",\n       y = \"Withdrawals (Mgal/day)\",\n       caption = \"Figure 1: Total Fresh Withdrawals in the USA 1950-2015.\\n(Plot created by A. Dextre. Data from USGS (2015)).\") +\n  theme(axis.text = element_text(color=\"grey\",size = 8),\n        axis.ticks.x = element_blank(),\n        axis.ticks.y = element_blank(),\n        panel.background = element_blank(),\n        panel.grid.major = element_line(size = 0.1, color = \"grey\"),\n        plot.caption = element_text(hjust = 0, size = 10, face = \"bold\"),\n        #Positions legend, it is left blank because there is no legend\n        \n        legend.position = \"\") +\n  #Adjusts continuous scale on the x-axis (ex: 1950,1955,1960, etc.)\n  #Adds nice breaks for each tick on the x-axis\n  #Adds 20 breaks on the plot for the x-axis\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 20)) +\n  #Adjusts continuous scale on the y-axis\n  #Adds 10 nice breaks on the plot on the y-axis\n  #Adjusts scale limit from a min of \"0\" to a max of \"380000\"\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                     limits = c(0, 380000))\n\n\n\n\n\nNote: Data is presented differently for 1985 and afterwards than prior to 1985. The reason for this is because we now have data by county rather than by state. I accounted for this by grouping the columns by “State”, summarizing across the “state”, “year”, “agency”, “scode”, and “area” columns, and creating a “Year” column. I did this to merge the file columns under one state column, and since the “year” column was removed, I created a “Year” column with the corresponding year.\n\n\nTimeseries of U.S. Sectoral Withdrawals\n\n\nView Code\n#1.The code follows best practices\n\n#2.I used the function read_tsv(), which automatically accounts for a tab delimited file.\n\n#3.The code has been edited. I have looked through all the datasets and carefully selected the columns that should be numeric, including all FIPS columns from every dataset. I checked to make sure that state acronyms and names and county names, etc. were not changed to numeric. The reason it is important to coerce the FIPS into numeric for all datasets because FIPS is a numeric code and some data files have notes under the FIPS column and changing to numeric will convert the notes into \"NA\" and then to \"0\".\n\n#4. I did not get an error. I used replace(is.na(.), 0), which allows us to replace \"NA\" values to \"0\". I use \".\" in is.na(.) to let R know we are using the same object within the pipe operator\n\n#5. I filtered the dataset for 1990. The reason I needed to do this is because the first column is a state acronym and we want to keep it as a character data type and turn those without a state acronym from \"NA\" to \"0\".\n\n#### Code and Data check\n#1. I deselected the extra columns. I have 8 and 10 variables in d_wu_1950 and d_wu_1955, respectively.\n\n#2. I replaced column tags ir_wsw_fr and ir_wgw_fr with ir_w_fr_to. I did this because both ir_wsw_fr and ir_w_fr_to did not have data.\n\n#Create new object and assign it wu_all\nwu_all_sectors <- wu_all %>%\n  replace(is.na(.), 0) %>%\n  group_by(Sectors, Year) %>%\n  summarize(across(Withdrawals, sum))\nwu_all_check <- wu_all_sectors %>%\n  group_by(Sectors) %>%\n  summarize(across(Withdrawals, sum))\n#Check withdrawals by sector\nggplot() +\n  #The columns for sectors seem to be stack onto top of one another for each year\n  geom_col(data = wu_all_sectors, aes(x = Year, y = Withdrawals,\n                                      fill = reorder(Sectors, Withdrawals)),\n           #To put the columns side by side, we use the position_doge and width argument\n           width = 4, position = position_dodge(3.5)) +\n  scale_fill_manual(values = c(\"darkturquoise\", \"dodgerblue3\", \"red3\",\n                               \"orange2\", \"green4\")) +\n  #We need a line a line plot to illustrate \"Total Freshwater Withdrawals in the US from 1950-2015\"\n  geom_line(data = wu_all_plot, aes(x = Year, y = Withdrawals/2),\n            color = \"lightgray\", size = 1) +\n  #We need a point plot to help emphasize the data points for total\n  #withdrawals for each year\n  geom_point(data = wu_all_plot, aes(x = Year, y = Withdrawals/2),\n             color = \"lightgrey\", size = 2, fill = \"lightgrey\") +\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 14),\n                     expand = c(0,0)) +\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                     limits = c(0, 200000),\n                     label = label_comma(),\n                     #Expand = c(0,0) helps adjust the y-axis, to make \"0\" start at the\n                     #bottom of the axis\n                     expand = c(0,0),\n                     #The trans argument helps us transform our secondary axis\n                     #We multiply by 2, because our secondary axis needs to reflect the total\n                     #withdrawals for the US for 1950-2015, Which is double the amount of the axis\n                     #on the left side\n                     sec.axis = sec_axis(trans = ~.*2,\n                                         breaks = breaks_pretty(n = 10),\n                                         name = \"Total Withdrawals (Mgal/day)\\n\",\n                                         labels = label_comma())) +\n  labs(x = \"Year\",\n       y = \"Sector Withdrawals (Mgal/day)\",\n       caption = \"Figure 2: Fresh Water Withdrawals in the USA 1950-2015.\",\n       fill = \"\") +\n  #It adds a border to the around the plot and removes the grid in the background\n  theme_few() +\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.text.y.right = element_text(color = \"grey\", size = 8),\n        axis.text.y = element_text(color = \"black\", size = 8),\n        axis.text.x = element_text(color = \"black\", size = 8),\n        axis.title.y.right = element_text(color = \"grey\", size = 10),\n        axis.title.y.left = element_text(color = \"black\", size = 10),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        legend.position = \"top\",\n        plot.caption = element_text(hjust = 0, face = \"bold\", size = 10))\n\n\n\n\n\nFresh Water Withdrawals Trends by Sector in the USA (1950-2015) Total fresh water withdrawals increased from 1950 until peaking in the 1980s along with freshwater withdrawals for irrigation and thermoelectric use which are the biggest water-users. After 1980, overall total freshwater withdrawal started to decrease in the following years, with a slight increase in the 2000s. The decrease in total freshwater use is most likely due to more water conservation tactics and awareness regarding water scarcity. After 2005, there has been a big decrease in total freshwater withdrawals, likely due to implementations for recirculating and dry cooling processes for thermoelectric water use. Additionally, drought and water conversations may have impacted water withdrawals, specially for groundwater, for irrigation purposes.\nMy plot’s data appear to be different than the USGS plot.\nThe bar in the USGS plot show different patterns than my plot. The USGS’s plot shows thermoelectric as the biggest water-use sector for all years, while my plot shows irrigation as the biggest water-use sectro and thermoelectric as the second biggest water-user for most years, with an exception in 2005 and 2010. Additionally, the USGS plot illustrates total withdrawals, while my plot illustrates freshwater withdrawals.\n\n\nTimeseries of Sectoral Withdrawals for Colorado\n\n\nView Code\n#Create new object for sector water use for Colorado\nwu_co_sectors <- wu_all %>%\n  replace(is.na(.), 0) %>%\n  filter(State == 8)\n\n#Create a new object for total freshwater withdrawals for Colorado\nwu_co_all_plot <- wu_co_sectors %>%\n  select(-Sectors) %>%\n  replace(is.na(.), 0) %>%\n  group_by(Year) %>%\n  summarise(across(Withdrawals, sum))\n#Create a check for sectors in Colorado\nwu_co_all_check <- wu_co_sectors %>%\n  group_by(Sectors) %>%\n  summarize(across(Withdrawals, sum))\n#Create a plot for total withdrawals for each water use sector in Colorado\nggplot() +\n  #The columns for sectors seem to be stack onto top of one another for each year\n  geom_col(data = wu_co_sectors, aes(x = Year, y = Withdrawals,\n                                     fill = reorder(Sectors, Withdrawals)),\n           #To put the columns side by side, we use the position_doge and width argument\n           width = 4, position = position_dodge(3.5)) +\n  scale_fill_manual(values = c(\"darkturquoise\", \"orange2\", \"red3\",\n                               \"dodgerblue3\", \"green4\")) +\n  #We need a line a line plot to illustrate \"Total Freshwater Withdrawals in\n  #Colorado from 1950-2015\"\n  geom_line(data = wu_co_all_plot, aes(x = Year, y = Withdrawals*1.25),\n            color = \"lightgray\", size = 1) +\n  #We need a point plot to help emphasize the data points for total withdrawals\n  #for each year\n  geom_point(data = wu_co_all_plot, aes(x = Year, y = Withdrawals*1.25),\n             color = \"lightgrey\", size = 2, fill = \"lightgrey\") +\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 14),\n                     expand = c(0,0)) +\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                     limits = c(0, 20000),\n                     label = label_comma(),\n                     #Expand = c(0,0) helps adjust the y-axis, to make \"0\" start at the bottom\n                     #of the axis\n                     expand = c(0,0),\n                     #The trans argument helps us transform our secondary axis\n                     #We multiply by 2, because our secondary axis needs to reflect the\n                     #total withdrawals for the US for 1950-2015, Which is double the amount of\n                     #the axis on the left side\n                     #**What transformation did you pick and why?**\n                     #I picked 1.25 transformation for my line plot and secondary axis.\n                     #I did this because water use for the irrigation sector is so large that a lower\n                     #transformation, like one-to-one, resulted in an overlap between my bar plot and\n                     #line plot making it difficult to read the data. Additionally, any larger\n                     #transformation will make my line plot not within bounds of the plot and if the\n                     #limits where adjust to show the line plot, then the bar columns for other\n                     \n                     #water-use sectors will be very small and not show on the plot.\n                     sec.axis = sec_axis(trans = ~./1,\n                                         breaks = breaks_pretty(n = 10),\n                                         name = \"Total Withdrawals (Mgal/day)\\n\",\n                                         labels = label_comma())) +\n  labs(x = \"Year\",\n       y = \"Sector Withdrawals (Mgal/day)\",\n       caption = \"Figure 3: Fresh Water Withdrawals in CO 1950-2015.\",\n       fill = \"\") +\n  #It adds a border to the around the plot and removes the grid in the background\n  theme_few() +\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.text.y.right = element_text(color = \"grey\", size = 8),\n        axis.text.y = element_text(color = \"black\", size = 8),\n        axis.text.x = element_text(color = \"black\", size = 8),\n        axis.title.y.right = element_text(color = \"grey\", size = 10),\n        axis.title.y.left = element_text(color = \"black\", size = 10),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        legend.position = \"top\",\n        plot.caption = element_text(hjust = 0, face = \"bold\", size = 10))\n\n\n\n\n\nFresh Water Withdrawals by Sector in Colorado (1950-2015) Total fresh water withdrawals in Colorado have generally increased from 1950 until 1970, with a decrease in water use in 1955. Additionally, there was a huge decrease in fresh water withdrawals in 1975, however a huge spike in fresh water withdrawal in 1980 followed. Despite the fresh water withdrawal spike in 1980, the following years (1985-2005) generally show a decrease in fresh water withdrawals, with some increases in 1995 and 2005. After 2005, there has been a big decrease in fresh water withdrawals, specially in irrigation, this is mostly due to conservation practices, water scarcity awareness, and drought conditions that plagued Colorado.\nFresh Water Withdrawals by Sector: Colorado vs USA (1950-2015) Both Colorado and the whole US, peaked in fresh water withdrawals in the 1980s. Additionally, freshwater withdrawals in the US and Colorado, is that fresh water withdrawals decreased in 2005 and continued onward. Moreover, irrigation is the biggest water use sector for both portfolios. One major difference between the US and Colorado water portfolio is that in the US there was a continuous increase in fresh water withdrawals from 1950 until 1980, whereas Colorado had dips in freshwater withdrawals from 1950 to 1980. Moreover, irrigation and thermoelectric are the US biggest water use sectors, whereas Colorado’s biggest water use sector is just irrigation.\n\n\nTimeseries of State Freshwater Use\n\n\nView Code\nfips <- d_wu_2015 %>%\n  select(state, State = statefips) %>%\n  unique() %>%\n  filter(!State %in% c(0, 11, 72, 78))\nps_all <- wu_all %>%\n  replace(is.na(.), 0) %>%\n  filter(Sectors == \"Public Supply\") %>%\n  inner_join(fips, by = \"State\")\nir_all <- wu_all %>%\n  replace(is.na(.), 0) %>%\n  filter(Sectors == \"Irrigation\") %>%\n  inner_join(fips, by = \"State\")\ndata1 <- c(\"ps_all\", \"ir_all\")\ncap <-c(\"Figure 4: Public supply by state. Data from USGS (2015).\\nCreated by Andre Dextre.\",\n        \"Figure 5: Irrigation by state. Data from USGS (2015)\\nCreated by Andre Dextre.\")\nmyplot <- function(data1, cap) {\n  ggplot() +\n    geom_line(data = data1,\n              aes(x = Year, y = Withdrawals, color = state),\n              size = 1) +\n   scale_color_manual(values = rep(c(\"darkblue\", \"royalblue4\", \"steelblue3\",\n                                      \"dodgerblue2\", \"skyblue\"), 10)) +\n    gghighlight(max(Withdrawals), max_highlight = 5L,\n                unhighlighted_params = list(size = .5, color = alpha(\"grey\", 0.4)),\n                label_params = list(size = 3, fill = \"white\", fontface = \"bold\",\n                                    color = c(\"darkblue\",\"royalblue4\", \"steelblue3\",\n                                              \"dodgerblue2\", \"skyblue\"))) +\n    #Edit the x and y axes\n    scale_x_continuous(breaks = breaks_pretty(n = 15),\n                       expand = c(0,1)) +\n    scale_y_continuous(breaks = breaks_pretty(n = 7),\n                       expand = c(0,0),\n                       labels = label_comma() ) +\n    #Add caption and labels\n    labs(caption = cap,\n         x = \"\\nYear\\n\",\n         y = \"Withdrawals (Mgal/day)\\n\") +\n    #Adjust background, axes and labels\n    theme(axis.text = element_text(color = \"black\", size = 10),\n          panel.background = element_blank(),\n          axis.line = element_line(color = \"black\"),\n          plot.caption = element_text(hjust = 0, size = 12, face = \"bold\"),\n          legend.position = \"\")\n}\n#Create a far loop that sequences from 1 to the # of entries in data 1\nfor(i in seq_along(data1)){\n  print(myplot(get(data1[i]), cap[i]))\n}\n\n\n\n\n\n\n\n\nWater Use by State: Public Supply vs Irrigation\nThe most populous states such as California, Texas, New York, Florida, and Illinois are the biggest water users For public supply in the US. Additionally, for irrigation the biggest water users are western states that tend to have dry climates and depend on groundwater supply for irrigation.\n\n\nTimeseries of Groundwater and Surface Water Withdrawals for USA\n\n\nView Code\n#Create new object for years 1965 to 2015\n#SW is ps, ir/it, do, ls/li, oi/in/mi/pt\nsource_wu_1965 <- d_wu_1965 %>%\n  mutate(State = area,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + do_wsw_fr + ls_wsw_fr +\n           oi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + + ls_wgw_fr +\n           oi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 1965) %>%\n  select(State, Year, Total, GW, SW, Population) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")   \n\n#1970\nsource_wu_1970 <- d_wu_1970 %>%\n  mutate(State = area,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + do_wsw_fr + ls_wsw_fr +\n           oi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + + ls_wgw_fr +\n           oi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 1970) %>%\n  select(State, Year, Total, GW, SW, Population) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\") \n\n#1975\nsource_wu_1975 <- d_wu_1975 %>%\n  mutate(State = area,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + do_wsw_fr + ls_wsw_fr +\n           oi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + + ls_wgw_fr +\n           oi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 1975) %>%\n  select(State, Year, Total, SW, GW, Population) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")\n\n#1980\nsource_wu_1980 <- d_wu_1980 %>%\n  mutate(State = area,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + do_wsw_fr + ls_wsw_fr +\n           oi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + + ls_wgw_fr +\n           oi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 1980) %>%\n  select(State, Year, Total, GW, SW, Population) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")\n\n#From 1985 and on add the following:\n#Group by state\n#Add across columns 1:5\n#Add \"Year\" column\n\n#1985\nsource_wu_1985 <- d_wu_1985 %>%\n  mutate(State = scode,\n         Population = po_total,\n         SW = ps_wswfr + ir_wswfr + do_ssswf + ls_swtot + in_wswfr +\n           mi_wswfr + pt_wswfr,\n         GW = ps_wgwfr + ir_wgwfr + do_ssgwf + ls_gwtot + in_wgwfr +\n           mi_wgwfr + pt_wgwfr,\n         Total = SW + GW,\n         Year = 1985) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\") %>%\n  mutate(Year = 1985)\n\n#1990\nsource_wu_1990 <- d_wu_1990 %>%\n  mutate(State = scode,\n         Population = po_total,\n         SW = ps_wswfr + ir_wswfr + ls_swtot + do_ssswf + in_wswfr +\n           mi_wswfr + pt_wswfr,\n         GW = ps_wgwfr + ir_wgwfr + do_ssgwf + ls_gwtot + in_wgwfr +\n           mi_wgwfr + pt_wgwfr,\n         Total = SW + GW,\n         Year = 1990) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 1990) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")\n\n#1995\nsource_wu_1995 <- d_wu_1995 %>%\n  mutate(State = state_code,\n         Population = total_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + ls_wsw_fr + do_wsw_fr + in_wsw_fr +\n           mi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + ls_wgw_fr + in_wgw_fr +\n           mi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 1995) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 1995) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")\n\n#2000\nsource_wu_2000 <- d_wu_2000 %>%\n  mutate(State = statefips,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + it_wsw_fr + ls_wsw_fr + do_wsw_fr + mi_wsw_fr +\n           in_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + it_wgw_fr + do_wgw_fr + ls_wgw_fr + in_wgw_fr +\n           mi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 2000) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2000) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")   \n\n#2005\nsource_wu_2005 <- d_wu_2005 %>%\n  mutate(State = statefips,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + ls_wsw_fr + do_wsw_fr + in_wsw_fr +\n           mi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + ls_wgw_fr + in_wgw_fr +\n           mi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 2005) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2005) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")   \n\n#2010\nsource_wu_2010 <- d_wu_2010 %>%\n  mutate(State = statefips,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + li_wsw_fr + do_wsw_fr + mi_wsw_fr +\n           in_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + li_wgw_fr + in_wgw_fr +\n           mi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 2010) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2010) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\") \n\n#2015\nsource_wu_2015 <- d_wu_2015 %>%\n  mutate(State = statefips,\n         Population = tp_tot_pop,\n         SW = ps_wsw_fr + ir_wsw_fr + li_wsw_fr + do_wsw_fr + in_wsw_fr +\n           mi_wsw_fr + pt_wsw_fr,\n         GW = ps_wgw_fr + ir_wgw_fr + do_wgw_fr + li_wgw_fr + in_wgw_fr +\n           mi_wgw_fr + pt_wgw_fr,\n         Total = SW + GW,\n         Year = 2015) %>%\n  select(State, Population, SW, GW, Total, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2015) %>%\n  pivot_longer(3:5, names_to = \"Source\", values_to = \"Withdrawals\")\n\n#Combine all data frames\nwu_all_source <- rbind(source_wu_1965, source_wu_1970, source_wu_1975, source_wu_1980,\n                       source_wu_1985, source_wu_1990, source_wu_1995,\n                       source_wu_2000, source_wu_2005, source_wu_2010, source_wu_2015) %>%\n  filter(State != \"78\",\n         State != \"72\",\n         State != \"69\",\n         State != \"66\",\n         State != \"60\",\n         State != \"0\",\n         State != \"11\")\n\n#Now do population\npopulation <- wu_all_source %>%\n  filter(Source == \"GW\") %>%\n  select(-Source, -Withdrawals) %>%\n  group_by(Year) %>%\n  summarize(across(Population, sum))\n\n#Create source\nsource <- wu_all_source %>%\n  select(Source, Year, Withdrawals, State) %>%\n  group_by(Year, Source) %>%\n  summarize(across(Withdrawals, sum))\n\n#Create plot\nggplot() +\n  #The columns for sectors seem to be stack onto top of one another for each year\n  geom_col(data = source, aes(x = Year, y = Withdrawals,\n                              fill = reorder(Source, Withdrawals)),\n           stat = \"identity\",\n           color = \"black\",\n           #To put the columns side by side, we use the position_doge and width argument\n           width = 4, position = position_dodge(3.5)) +\n  scale_fill_manual(values = c(\"lightsteelblue\", \"deepskyblue\", \"midnightblue\")) +\n  #Create population line (pink)\n  geom_line(data = population, aes(x = Year, y = Population, col = \"Population\"),\n            size = 2) +\n  #Adds legend and color\n  scale_color_manual(values = c(\"deeppink\")) +\n  #Add highlight on the line plot\n  #Add Labels\n  labs(x = \"Year\",\n       y = \"Withdrawals (Mgal/day)\\n\",\n       caption = \"Figure 6: Trends in population and freshwater withdrawals by source in USA.\\nData from USGS (1965 - 2015)\",\n       fill = \"\") +\n  #Get rid of grid lines and makes the graph easier to read\n  theme_few() +\n  #Add theme and edit\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.ticks.x = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        plot.caption = element_text(hjust = 0, size = 10, face = \"bold\"),\n        legend.position = \"top\",\n        legend.title = element_blank(),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        axis.title.y = element_text(color = \"black\", size = 10),\n        axis.title.y.right = element_text(color = \"deeppink\", size = 10),\n        axis.text.y.right = element_text(color = \"deeppink\"),\n        text = element_text(size = 10)) +\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 14)) +\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                     limits = c(0, 400000),\n                     label = label_comma(),\n                     expand = c(0, 0),\n                     sec.axis = sec_axis(trans = ~./1000,\n                                         breaks = scales::pretty_breaks(n = 9),\n                                         name = \"Population (Millions)\\n\",\n                                         label = label_comma()))\n\n\n\n\n\nFreshwater Withdrawals by Source in the USA: Groundwater vs Surface Water (1965-2015)\nTotal Freshwater withdrawals had a steady increase from 1965 until it peaked in 1980. After 1985, total freshwater withdrawals decreased and plateaued from 1985 until 2005, where it continued to decreased. Freshwater withdrawals from surface water makes up most of the total freshwater withdrawals in the US. Fresh water withdrawals from groundwater saw a slight increased from 1965-1980, but it remained low in the following years compared to surface water freshwater withdrawals.\nTotal Freshwater Withdrawals and Population Trends in the USA (1965-2015) From 1965 to 1980, there is a positive correlation between an increasing population and total freshwater withdrawals. In 1985, total freshwater withdrawals started to decrease while population was still growing. Additionally, from 2005-2015, as population increased, total freshwater withdrawals decreased, this is likely due to more water conservation practices after the 1980s and water use reductions due to extreme drought in the American West.\n\n\nTimeseries of Groundwater and Surface Water Withdrawals for Colorado\n\n\nView Code\nwu_co_source <- wu_all_source %>%\n  filter(State == 8)\nsource_co <- wu_co_source %>%\n  select(Source, Year, Withdrawals, State) %>%\n  group_by(Year, Source) %>%\n  summarize(across(Withdrawals, sum))\n\npopulation_co <- wu_co_source %>%\n  filter(Source == \"GW\") %>%\n  select(-Source, -Withdrawals) %>%\n  group_by(Year) %>%\n  summarize(across(Population, sum))\n\nggplot() +\n  geom_col(data = source_co, aes(x = Year, y = Withdrawals,\n                                 fill = reorder(Source, Withdrawals)),\n           stat = \"identity\",\n           color = \"black\",\n           width = 4,\n           position = position_dodge(3.5)) +\n  scale_fill_manual(values = c(\"lightsteelblue\", \"deepskyblue\", \"midnightblue\")) +\n  #Creates a ggplot with pink line\n  geom_line(data = population_co, aes(x = Year, y = Population*2, col = \"Population\"),\n            size = 2) +\n  scale_color_manual(values = c(\"deeppink\")) +\n  #adds labels on x and y axis as well as a figure caption\n  labs(x = \"Year\",\n       y = \"Withdrawals (Mgal/day)\\n\",\n       caption = \"Figure 7: Trends in population and fresh water withdrawals by source in CO.\nData from USGS (1965 - 2015)\",\nfill = \"\") +\n  #this code got rid of grid lines in the background\n  #and makes the graph easier to read\n  theme_few() +\n  #One piece of code not outlined here is axis.ticks.y and .x = element_line which adds in the axis tick#I implemented the code as follows:\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.ticks.x = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        plot.caption = element_text(hjust = 0, size = 10, face = \"bold\"),\n        legend.position = \"top\",\n        legend.title = element_blank(),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        axis.title.y = element_text(color = \"black\", size = 10),\n        axis.title.y.right = element_text(color = \"deeppink\", size = 10),\n        axis.text.y.right = element_text(color = \"deeppink\"),\n        text = element_text(size = 10)) +\n  #puts more years on the x-axis\n  scale_x_continuous(breaks = scales::pretty_breaks(n=14)) +\n  #puts more withdrawal numbers on the y axis between the numbers 0 and 2000000\n  #the trans argument is multiplying by two because we need a way to represent\n  #the data that has been manipulated by dividing by two. This way the data can\n  #remain within the graph and still represent the real values of withdrawals.\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                     limits = c(0, 16000),\n                     label = label_comma(),\n                     #the expand code gets rid of the space between column bars and the x-axis\n                     expand = c(0,0),\n                     sec.axis = sec_axis(trans = ~./2,\n                                         breaks = scales::pretty_breaks(n = 9),\n                                         name = \"Population (Millions)\\n\",\n                                         label = label_comma()))\n\n\n\n\n\nFreshwater Withdrawals by Source in Colorado: Groundwater vs Surface Water (1965-2015) From 1965-2015, the biggest water source for freshwater withdrawals is surface water. From 1965-1970, there was an increased in freshwater withdrawals from both surface water and groundwater. Additionally, there was a huge decrease in surface water withdrawals in 1975, however there was an increase in groundwater withdrawals as well, which was followed by a huge spike in fresh water withdrawal in 1980.From 1985-2005, freshwater withdrawals from surface water and groundwater showed decreased in surface water withdrawals compared to its 1980 peak. After 2005, both surface water and groundwater freshwater withdrawals decreased, most likely due to conservation practices during times of drought.\nTotal Freshwater Withdrawals and Population Trends in Colorado (1965-2015) Generally, from 1965-1980, as population increased so did total freshwater withdrawals. Additionally, in 1985 and 1990, there was a slight dip in population correlates to a dip in total freshwater withdrawals in Colorado. From 1995-2005, there has been a positive correlation between population and freshwater withdrawals. However, from 2010 and onward, as population increased, total freshwater withdrawals has decreased. This decrease may correspond to water conservation practices during drought periods in Colorado.\nTotal Freshwater Withdrawals and Population Trends: Colorado vs USA (1965-2015) One common similarity between the USA plot and Colorado plot, is that the biggest source for freshwater withdrawals is surface water. Another similarity between the two plots is that total freshwater withdrawals peaked in 1980. Additionally, another pattern between both plots is that even though population kept increasing after 2005, total freshwater withdrawals started to decreased. One major difference between the USA plot and Colorado plot is that US total freshwater withdrawals generally increased from 1965 until 1980 and then decreased in the following years. Whereas, Colorado’s total freshwater withdrawals had increases and dips in total freshwater withdrawals from 1965-2015. Another major difference, is that the USA held a steady increase in population throughout 1965-1985, whereas Colorado did see an increasing population, however it did not held a constant increase due to a slight decline in population in 1990.\n\n\nInteractive Map: US Irrigation Methods & Water Withdrawals (Mgal/d)\n\n\n\n\n\n\nIrrigation Methods:\nFlood: Water is applied freely and distributed over the soil surface by gravity.\nSprinkler: Applies water in a controlled manner in a way similar to rainfall.\nMicro-irrigation: Allows water to slowly drip to roots of plants, water is placed directly into the root zone to minimize evaporation.\n\n\n\n\nCitationBibTeX citation:@online{dextre2022,\n  author = {Andre Dextre},\n  title = {United {States’} {Water-Use} {Data} {Portfolio} (1950-2015)},\n  date = {2022-12-09},\n  url = {https://github.com/andredextre/Water_Portfolio},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nAndre Dextre. 2022. “United States’ Water-Use Data Portfolio\n(1950-2015).” December 9, 2022. https://github.com/andredextre/Water_Portfolio."
  },
  {
    "objectID": "Scratch/2022-10-24-class-example/index.html",
    "href": "Scratch/2022-10-24-class-example/index.html",
    "title": "Dre’s First Blog",
    "section": "",
    "text": "Hi this is my class example\nHere’s some more text\nSam Csik Blog: (Csik 2022)\n\n\nAirbnb failed to disrupt the hotel industry.\n\n— Unobtainium Daydreams ((ShimminyKricket?)) October 24, 2022\n\n\n\n\n\n\nReferences\n\nCsik, Samantha. 2022. “Adding a Blog to Your Existing Quarto Website.” October 24, 2022. https://samanthacsik.github.io/posts/2022-10-24-quarto-blogs/.\n\nCitationBibTeX citation:@online{dextre2022,\n  author = {Andre Dextre},\n  title = {Dre’s {First} {Blog}},\n  date = {2022-10-24},\n  url = {https://andredextre.github.io/posts/2022-10-24-class-example},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nAndre Dextre. 2022. “Dre’s First Blog.” October 24, 2022.\nhttps://andredextre.github.io/posts/2022-10-24-class-example."
  },
  {
    "objectID": "Scratch/groundwater_data/index.html",
    "href": "Scratch/groundwater_data/index.html",
    "title": "Where is California’s Groundwater Going?",
    "section": "",
    "text": "Due to climate change, the state of California is more susceptible to longer periods of drought, ultimately affecting the states overall water supply.1 Aside from surface water, California heavily depends on its reservoir storage and groundwater supply to provide water to its ~40 million residents. Due to prolong drought, average snow and rainfall is not highly reliable every year. Since 2000, California has experience two in 2007-2009 and with the longest drought period being from 2011-2017. In this statistical analysis, we will examine how precipitation (snow and rainfall) are affecting reservoir storage and groundwater levels from 1999-2019."
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#data",
    "href": "Scratch/groundwater_data/index.html#data",
    "title": "Where is California’s Groundwater Going?",
    "section": "Data",
    "text": "Data\n\nSnow/Rainfall Data\nFor this statistical analysis, I’ve obtained “Water Year” data from UC Berkeley’s Central Sierra Snow-lab2. This data set contains snow and rainfall data for water years 1971-2019 in a CSV format.\n\n\nView Code\n#Read in water year data\n\n#Read in the Water Year  2000 Data\nwy_2000 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2000.csv\" ), na = c(\"T\", \"NA\", \"--\")) %>% \n  clean_names() %>% \n  replace(is.na(.), 0) %>%\n  select(!remarks)\n#Read in the Water Year  2001 Data\nwy_2001 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2001.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  transform(new_snow_cm = as.numeric(new_snow_cm)) %>%\n  replace(is.na(.), 0) %>%\n  select(!remarks)\n#Read in the Water Year  2002 Data\nwy_2002 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2002.csv\"), na = c(\"T\", \"NA\", \"--\"))%>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2003 Data\nwy_2003 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2003.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)\n#Read in the Water Year  2004 Data\nwy_2004 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2004.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2005 Data\nwy_2005 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2005.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)\n#Read in the Water Year  2006 Data\nwy_2006 <- read_csv(here(datadir,\"water_year_data\", \"Whole_WY_2006.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2007 Data\nwy_2007 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2007.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2008 Data\nwy_2008 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2008.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)\n#Read in the Water Year  2009 Data\nwy_2009 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2009.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2010 Data\nwy_2010 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2010.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2011 Data\nwy_2011 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2011.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2012 Data\nwy_2012 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2012.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2013 Data\nwy_2013 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2013.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2014 Data\nwy_2014 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2014.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2015 Data\nwy_2015 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2015.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2016 Data\nwy_2016 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2016.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)\n#Read in the Water Year  2017 Data\nwy_2017 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2017.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)\n#Read in the Water Year  2018 Data\nwy_2018 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2018.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names() %>%\n  select(!remarks) %>%\n  replace(is.na(.), 0) \n#Read in the Water Year  2019 Data\nwy_2019 <- read_csv(here(datadir, \"water_year_data\", \"Whole_WY_2019.csv\"), na = c(\"T\", \"NA\", \"--\")) %>%\n  clean_names()%>%\n  select(!remarks) %>%\n  replace(is.na(.), 0)"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#reservoir-data",
    "href": "Scratch/groundwater_data/index.html#reservoir-data",
    "title": "Where is California’s Groundwater Going?",
    "section": "Reservoir Data",
    "text": "Reservoir Data\nAdditionally, for this analysis, I’ve obtained reservoir elevation and storage data from CA Department of Natural Resources & CA Department of Water Resources3. This data set provides daily reservoir elevation and storage data from 1981-2022. One limitation to this data set is that it only provide data on reservoirs part of the State Water Project, therefore my focus will be based on the San Luis Reservoir near Los Banos, California.\n\n\nView Code\n#Read in reservoir data\nreservoir_data <- read_csv(here(datadir, \"reservoir_data\", \"reservoir_data.csv\"), na = c(\"NA\")) %>%\n  mutate(date = lubridate::mdy(date)) %>%\n  mutate(year = floor_date(date, \"year\"),\n         year = lubridate::year(year)) %>%\n  select(year, field_division, reservoir, elevation, storage) %>%\n  replace(is.na(.), 0) %>% \n  filter(reservoir == \"San Luis\")"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#groundwater-measurement-data",
    "href": "Scratch/groundwater_data/index.html#groundwater-measurement-data",
    "title": "Where is California’s Groundwater Going?",
    "section": "Groundwater Measurement Data",
    "text": "Groundwater Measurement Data\nMoreover, for this analysis, I’ve obtained groundwater measurement data from CA Department of Natural Resources & CA Department of Water Resources4. This data set contains historical daily groundwater measurements for aquifers throughout all of California.\n\n\nView Code\n#Read in groundwater measurement and stations data\ngw_measurements <- read_csv(here(datadir, \"gw_measurements\", \"measurements.csv\")) \n\nstations <- read_csv(here(datadir, \"gw_measurements\", \"stations.csv\")) %>%\n  select(site_code, county_name)\n\ngw_levels <- right_join(gw_measurements, stations, by = \"site_code\") %>%\n  mutate(gw_elevation = gwe,\n         msmt_date = format(as.POSIXct(msmt_date,\n                                      format='%Y/%m/%d %H:%M:%S'),\n                                      format='%Y/%m/%d')) %>% #dropping time from date data\n  mutate(date = ymd(msmt_date),   \n         year = lubridate::year(date))"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#water-use-data",
    "href": "Scratch/groundwater_data/index.html#water-use-data",
    "title": "Where is California’s Groundwater Going?",
    "section": "Water Use Data",
    "text": "Water Use Data\nFinally, I’ve obtained water use data collected by the U.S Geological Survey (USGS)5. This data set contains water withdrawal data by different demand sectors for years 1950-2015.\n\n\nView Code\n#Read in water use data 2000 - 2015\n#Read 2000 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2000 <- read_xls(here(datadir, \"water_use\", \"us2000.xls\")) %>% \n  clean_names() %>% \n  filter(state != \"NA\") %>%\n  mutate(across(c(2:70), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2005 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2005 <- read_xls(here(datadir,\"water_use\", \"us2005.xls\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate(across(c(2:4), as.numeric)) %>%\n  mutate(across(c(6:108), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2010 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2010 <- read_xlsx(here(datadir, \"water_use\", \"us2010.xlsx\")) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate_at((2), as.numeric) %>%\n  mutate(across(c(4:117), as.numeric)) %>%\n  replace(is.na(.), 0)\n#Read 2015 data, clean names, turn to numeric, filter NA in state,\n#and replace NA with 0\nd_wu_2015 <- read_xlsx(here(datadir, \"water_use\", \"us2015.xlsx\"), skip = 1) %>%\n  clean_names() %>%\n  filter(state != \"NA\") %>%\n  mutate_at((2), as.numeric) %>%\n  mutate(across(c(4:141), as.numeric)) %>%\n  replace(is.na(.), 0)"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#data-scatter-plot",
    "href": "Scratch/groundwater_data/index.html#data-scatter-plot",
    "title": "Where is California’s Groundwater Going?",
    "section": "Data Scatter Plot",
    "text": "Data Scatter Plot\nTo start off my analysis, I’ve combined all my water year data from multiple years into one single dataframe after I filter out years not needed for this analysis, since the focus is from the 1999-2019 time period. Afterwards, I found the monthly and yearly average for each month/year in the dataframe. Next, I combined my water year data with the reservoir data (filtered out for the San Luis Reservoir from 1999-2019). Lastly, I created a scatter plot to check for any correlation between San Luis Reservoir storage (Acre-feet) and average seasonal snowfall/rainfall (cm).\nAs expected, there is a correlation between San Luis reservoir storage with average seasonal snowfall/rainfall.\n\n\nView Code\n#Wrangle water year data\n#Merge water year 2000-2003 data into one\nwy_2000_2003 <- list(wy_2000, wy_2001, wy_2002, wy_2003) %>%  \n  reduce(full_join)\n#Merge water year 2004-2019 data into one\nwy_2004_2019 <- list(wy_2004, wy_2005, wy_2006, wy_2007,\n                     wy_2008, wy_2009, wy_2010, wy_2011,\n                     wy_2012, wy_2013, wy_2014, wy_2015,\n                     wy_2016, wy_2017,wy_2018, wy_2019) %>%\n  reduce(full_join) %>%\n  mutate(date = lubridate::mdy(date))\n#Join both merged data frames together\nwater_year <- full_join(wy_2000_2003, wy_2004_2019) %>%\n  rename(total_precip_mm = x24_hour_total_precip_mm,\n        date = date) %>%\n  mutate(avg_temp_c = (air_temp_max_c + air_temp_min_c)/2,\n         total_precip_cm = total_precip_mm/10)\n#Monthly average\nwy_monthly_avg <- water_year %>%\n  mutate(date = floor_date(water_year$date, \"month\")) %>%\n  select(date,\n         avg_temp_c,\n         new_snow_cm, \n         snowpack_depth_cm,\n         season_total_snow_cm,\n         snow_water_equivalent_cm, \n         percent_of_precip_as_snow,\n         total_precip_cm, \n         season_total_precip_mm,\n         percent_of_precip_as_rain) %>%\n   group_by(date) %>%\n  summarise(date = mean(date),\n            avg_temp_c = round(mean(avg_temp_c), 2),\n            new_snow_cm = round(mean(new_snow_cm), 2),\n            snowpack_depth_cm = round(mean(snowpack_depth_cm), 2),\n            season_total_snow_cm = round(mean(season_total_snow_cm), 2),\n            snow_water_equivalent_cm = round(mean(snow_water_equivalent_cm), 2),\n            percent_of_precip_as_snow = round(mean(percent_of_precip_as_snow), 2),\n            total_rain_cm = round(sum((total_precip_cm), 2)),\n            season_total_precip_mm = round(mean(season_total_precip_mm), 2),\n            percent_of_precip_as_rain = round(mean(percent_of_precip_as_rain), 2))\n\nwy_monthly_total <-  water_year %>%\n  mutate(date = floor_date(water_year$date, \"month\")) %>%\n  select(date,\n         avg_temp_c,\n         new_snow_cm, \n         snowpack_depth_cm,\n         season_total_snow_cm,\n         snow_water_equivalent_cm, \n         percent_of_precip_as_snow,\n         total_precip_cm, \n         season_total_precip_mm,\n         percent_of_precip_as_rain) %>%\n   group_by(date) %>%\n  summarise(date = mean(date),\n            avg_temp_c = round(mean(avg_temp_c), 2),\n            new_snow_cm = round(sum(new_snow_cm), 2),\n            snowpack_depth_cm = round(sum(snowpack_depth_cm), 2),\n            season_total_snow_cm = round(sum(season_total_snow_cm), 2),\n            snow_water_equivalent_cm = round(sum(snow_water_equivalent_cm), 2),\n            percent_of_precip_as_snow = round(mean(percent_of_precip_as_snow), 2),\n            total_rain_cm = round(sum((total_precip_cm), 2)),\n            season_total_precip_mm = round(mean(season_total_precip_mm), 2),\n            percent_of_precip_as_rain = round(mean(percent_of_precip_as_rain), 2))\n#Find cumulative precipitation and snow levels for each year\nwy_year_cumulative <- water_year %>%\n  mutate(year = floor_date(water_year$date, \"year\"),\n         year = lubridate::year(year)) %>%\n  group_by(year) %>%\n  select(year, \n         new_snow_cm, \n         season_total_snow_cm,\n         season_total_precip_mm,\n         snowpack_depth_cm,\n         total_precip_cm,\n         snow_water_equivalent_cm) %>%\n  summarise(year = mean(year),\n            new_snow_cm = round(sum(new_snow_cm), 2),\n            season_total_snow_cm = round(sum(season_total_snow_cm), 2),\n            season_total_precip_cm = round(sum((season_total_precip_mm/10), 2)),\n            snowpack_depth_cm = round(sum(snowpack_depth_cm), 2),\n            total_rain_cm = round(sum(total_precip_cm), 2),\n            snow_water_equivalent_cm = round(sum(snow_water_equivalent_cm), 2),\n            total_precipitation_cm = (season_total_precip_cm + season_total_snow_cm))\n\nwater_year_avg <- water_year %>%\n  mutate(year = floor_date(water_year$date, \"year\"),\n         year = lubridate::year(year)) %>%\n  group_by(year) %>%\n  select(year, \n         new_snow_cm, \n         season_total_snow_cm,\n         season_total_precip_mm,\n         snowpack_depth_cm,\n         total_precip_cm,\n         snow_water_equivalent_cm) %>%\n  summarise(year = mean(year),\n            new_snow_cm = round(mean(new_snow_cm), 2),\n            season_total_snow_cm = round(sum(season_total_snow_cm), 2),\n            snowpack_depth_cm = mean(sum(snowpack_depth_cm), 2),\n            season_total_precip_cm = round(sum(total_precip_cm), 2),\n            snow_water_equivalent_cm = round(sum(snow_water_equivalent_cm), 2),\n            total_precip = (total_precip_cm + snow_water_equivalent_cm))\n\n\n\n\nView Code\n#wrangle reservoir data\nreservoir_avg <- reservoir_data %>%\n  group_by(year) %>%\n  summarise(elevation = round(mean(elevation, na.rm = TRUE), 2),\n            storage = round(mean(storage, na.rm = TRUE), 2),\n            ) %>% \n  filter(!year < 1999 & !year > 2019 )\n\n\n\n\nView Code\n##Merge water year average with reservoir level average\nwy_reservoir <- full_join(wy_year_cumulative, reservoir_avg) %>%\n  filter(!year >= 2020)\n\n\n\n\nView Code\nsnowpack_storage <- ggplot(data = wy_reservoir,\n       aes(x = season_total_snow_cm,\n           y = storage)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              formula = y~x,\n              se = TRUE,\n              size = 2,\n              col = \"cadetblue4\") +\n  labs(x = \"Average Seasonal Snowfall (cm)\",\n       y = \"San Luis Reservoir Level (AF)\") +\n  theme_classic()\n\nrainfall_storage <- ggplot(data = wy_reservoir,\n       aes(x = season_total_precip_cm,\n           y = storage)) +\n  geom_point() +\n  geom_smooth(method = \"lm\",\n              formula = y~x,\n              se = TRUE,\n              size = 2,\n              col = \"cadetblue4\") +\n  labs(x = \"Average Seasonal Rainfall (cm)\",\n       y = \"San Luis Reservoir Level (AF)\") +\n  theme_classic()\n\ngridExtra::grid.arrange(snowpack_storage, rainfall_storage)"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#analysis-plan",
    "href": "Scratch/groundwater_data/index.html#analysis-plan",
    "title": "Where is California’s Groundwater Going?",
    "section": "Analysis Plan",
    "text": "Analysis Plan\nTo further dig deep into this analysis, I plan to run the following statistical test:\n\nTime Series - This will help us observed how San Luis Reservoir storage levels, total precipitation (snow + rainfall) levels, and groundwater elevation have changed over time.\nLinear Regression - With a single liner regression, we can determine how total precipitation levels influence reservoir levels or overall groundwater levels in California. Then we will check for P-value to determine if it is statistically significant. Additionally, we will check for R^2 value to see how much total precipitation influences storage levels and groundwater levels."
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#results",
    "href": "Scratch/groundwater_data/index.html#results",
    "title": "Where is California’s Groundwater Going?",
    "section": "Results",
    "text": "Results\n\nTime Series\nFor this time series, I first had to find the average annual groundwater elevation for each year in our observation. Next, I merged average annual groundwater elevation to our water year and reservoir data to plot for this time series.\nThe following time series shows a positive relationship between total precipitation (snow + rainfall) with storage levels in the San Luis Reservoir, which is expected. However, this time series shows that inverse relation between ground water elevation between total precipitation and storage levels from 2000-2019, which needs further investigation.\n\n\nView Code\n#Wranggling groundwater elevation data\n\n#Average monthly ground water levels\ngw_levels_monthly <- gw_levels %>%\n  mutate(date = floor_date(gw_levels$date, \"month\")) %>%\n  select(date, year, gw_elevation) %>%\n  filter(!year <= 1998 & !year > 2019) %>%\n  group_by(date) %>%\n  summarise(date = mean(date),\n            avg_gw_elevation = round(mean(gw_elevation, na.rm = TRUE), 2))\n\ngw_levels_monthly <- gw_levels_monthly[-c(1, 2, 3, 4, 5, 6, 7, 8, 9, 250, 251, 252), ]\n#Annual average gw levels\ngw_levels_year <- gw_levels %>%\n  mutate(date = floor_date(gw_levels$date, \"year\"), \n         date = lubridate::year(date)) %>%\n  select(date, year, gw_elevation) %>%\n  filter(!year < 1999 & !year > 2019) %>%\n  group_by(date) %>%\n  summarise(year = mean(date),\n            avg_gw_elevation = round(mean(gw_elevation, na.rm = TRUE), 2))\n\n\n\n\nView Code\n#Merge groundwater data with wy_reservoir data\nwy_reservoir <- left_join(wy_reservoir, gw_levels_year, by = \"year\") %>%\n  select(!year)\n#Merge\nmerged_wy_gw <- left_join(wy_monthly_total, gw_levels_monthly, by = \"date\") %>% \n  mutate(total_precip_cm = snow_water_equivalent_cm + total_rain_cm) \n\nwater_year_gw <- merged_wy_gw %>%\n  select(date, new_snow_cm, snowpack_depth_cm, total_rain_cm, avg_gw_elevation, total_precip_cm)\n\n\n\n\nView Code\n#Plot time series \nreservoir_ts <- reservoir_avg %>%\n  select(!year)\n\nwy_reservoir_ts <- wy_reservoir %>%\n  mutate(total_snow = season_total_snow_cm,\n         total_rainfall = season_total_precip_cm,\n         total_precip = total_snow + total_rainfall,\n         gw_elevation = avg_gw_elevation,\n         storage = storage) %>%\n  select(total_precip, storage, gw_elevation)\n\nplot(ts(data = wy_reservoir_ts, start = 1999, end = 2019),\n      main = \"Hydrological Time Series\") +\n  theme_classic()\n\n\n\n\n\nNULL"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#single-linear-regression",
    "href": "Scratch/groundwater_data/index.html#single-linear-regression",
    "title": "Where is California’s Groundwater Going?",
    "section": "Single Linear Regression",
    "text": "Single Linear Regression\nFor the linear regression, I decided to focus on groundwater elevation and total precipitation. To run the following linear model, I use the lm() function in R to run the following regression.\n\n\nView Code\nlin_mod <- lm(gw_elevation ~ total_precip, data = wy_reservoir_ts)\n\ntab_model(lin_mod)\n\n\n\n\n\n \ngw elevation\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n922.27\n541.41 – 1303.13\n<0.001\n\n\ntotal precip\n-0.00\n-0.00 – 0.00\n0.736\n\n\nObservations\n21\n\n\nR2 / R2 adjusted\n0.006 / -0.046\n\n\n\n\n\n\nView Code\nsummary(lm(gw_elevation ~ total_precip, data = wy_reservoir_ts)) %>%\n  tidy() \n\n\n# A tibble: 2 × 5\n  term           estimate  std.error statistic   p.value\n  <chr>             <dbl>      <dbl>     <dbl>     <dbl>\n1 (Intercept)  922.       182.           5.07  0.0000683\n2 total_precip  -0.000230   0.000672    -0.343 0.736    \n\n\nLimitation Note: total_precip estimate is -0.000230, not shown in table produce by R.\nInterpretation: When total precipitation is 0, then total groundwater elevation is estimated to be 922.27 ft . For every additional centimeter of precipitation, there is a decrease of 0.000239 ft in groundwater elevation. Additionally, P-value for total precipitation tell us that the results are not statistically significant and R^2 coefficient tell us that total precipitation does not influence groundwater elevation.\nWe need to take a further look!"
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#further-analysis",
    "href": "Scratch/groundwater_data/index.html#further-analysis",
    "title": "Where is California’s Groundwater Going?",
    "section": "Further Analysis",
    "text": "Further Analysis\nGiven the results from the liner regression, I decided to take a further look into what is causing groundwater elevation to decrease when there is snow and rainfall.\nFor a further analysis, I decided to take a look at total groundwater withdrawals utilizing the data obtained from the U.S Geological Survey.\n\n\nView Code\n#Wrangle CA water use data\n#Assign d_wu_year to wu_year\n#Create new columns (State, Public Supply, Irrigation, Rural, Industrial, Thermoelectric, and Year)\n#Pivot longer to create \"Sectors\" and \"Withdrawals\" column\nwu_2000 <- d_wu_2000 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr, \n          Irrigation = it_wgw_fr,\n          Rural = do_wgw_fr + ls_wgw_fr,\n          Industrial = in_wgw_fr + mi_wgw_fr,\n          Thermoelectric = pt_wgw_fr,\n          Year = 2000) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2000) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n#2005\nwu_2005 <- d_wu_2005 %>%\n  mutate(State = statefips,\n         \"Public Supply\" = ps_wgw_fr,\n         Irrigation = ir_wgw_fr,\n         Rural = do_wgw_fr + ls_wgw_fr,\n         Industrial = in_wgw_fr + mi_wgw_fr,\n         Thermoelectric = pt_wgw_fr,\n         Year = 2005) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarize(across(1:5, sum)) %>%\n  mutate(Year = 2005) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n#2010\nwu_2010 <- d_wu_2010 %>%\n  mutate(State = statefips,\n        \"Public Supply\" = ps_wgw_fr,\n        Irrigation = ir_wgw_fr,\n        Rural = do_wgw_fr + li_wgw_fr,\n        Industrial = in_wgw_fr + mi_wgw_fr,\n        Thermoelectric = pt_wgw_fr,\n        Year = 2010) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2010) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n#2015\nwu_2015 <- d_wu_2015 %>%\n  mutate(State = statefips,\n        \"Public Supply\" = ps_wgw_fr,\n        Irrigation = ir_wgw_fr,\n        Rural = do_wgw_fr + li_wgw_fr,\n        Industrial = in_wgw_fr + mi_wgw_fr,\n        Thermoelectric = pt_wgw_fr,\n        Year = 2015) %>%\n  select(State, \"Public Supply\", Irrigation, Rural, Industrial, Thermoelectric, Year) %>%\n  group_by(State) %>%\n  summarise(across(1:5, sum)) %>%\n  mutate(Year = 2015) %>%\n  pivot_longer(2:6, names_to = \"Sectors\", values_to = \"Withdrawals\")\n\n\n\n\nView Code\n#Combine \n#Remove unnecessary FIPS\nwu_all <- rbind(wu_2000, wu_2005, wu_2010, wu_2015) %>%\n  filter(State != \"78\",\n         State != \"72\",\n         State != \"69\",\n         State != \"66\",\n         State != \"60\",\n         State != \"0\",\n         State != \"11\")\n#Create new object for sector water use for California\nca_water_use <- wu_all %>%\n                 replace(is.na(.), 0) %>%\n                 filter(State == 6)\n\n#Create a new object for total freshwater withdrawals for California\nca_wu_all <- ca_water_use %>%\n  select(-Sectors) %>%\n  replace(is.na(.), 0) %>%\n  group_by(Year) %>%\n  summarise(across(Withdrawals, sum))\n\n\n\n\nView Code\n#Plot CA total groundwater withdrawals\nggplot() +\n  geom_line(data = ca_wu_all, aes(x = Year, y = Withdrawals),\n            color = \"black\", size = 1) +\n#We need a point plot to help emphasize the data points for total withdrawals for each year\n  geom_point(data = ca_wu_all, aes(x = Year, y = Withdrawals),\n            color = \"black\", size = 2, fill = \"black\") +\n\n  scale_x_continuous(breaks = scales::pretty_breaks(n = 5),\n                     limits = c(1999, 2017),\n                    expand = c(0,0)) +\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                    limits = c(0, 20000),\n                    label = label_comma(),\n                    expand = c(0,0)) +\n  labs(x = \"Year\",\n       y = \"Total GW Withdrawals (Mgal/day)\",\n       caption = \"Figure 1: GroundWater Withdrawals in CA 2000-2015.\",\n       fill = \"\") +\n  theme_classic() +\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.text.y = element_text(color = \"black\", size = 8),\n        axis.text.x = element_text(color = \"black\", size = 8),\n        axis.title.y = element_text(color = \"black\", size = 10),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        legend.position = \"top\",\n        plot.caption = element_text(hjust = 0, face = \"bold\", size = 10))\n\n\n\n\n\n\n\nView Code\n#Plot time series \nreservoir_ts <- reservoir_avg %>%\n  select(!year)\n\nwy_reservoir_ts <- wy_reservoir %>%\n  mutate(total_snow = season_total_snow_cm,\n         total_rainfall = season_total_precip_cm,\n         total_precip = total_snow + total_rainfall,\n         gw_elevation = avg_gw_elevation,\n         storage = storage) %>%\n  select(total_precip, storage, gw_elevation)\n\nplot(ts(data = wy_reservoir_ts, start = 1999, end = 2019),\n      main = \"Hydrological Time Series\") +\n  theme_classic()\n\n\n\n\n\nNULL\n\n\nGiven the the plot of total groundwater withdrawals in California compared to out time series. It looks like there might be a connection between decreasing groundwater levels and increasing groundwater withdrawals, which makes sense since California highly depends on it groundwater supply for water.\nBut now, my question is who is pumping all this groundwater?\nTo take a further look, I sorted out groundwater withdrawals with demand sectors to plot it.\n\n\nView Code\n##Create a plot for total withdrawals for each water use sector in California\nggplot() +\n#The columns for sectors seem to be stack onto top of one another for each year\n  geom_col(data = ca_water_use, aes(x = Year, y = Withdrawals,\n           fill = reorder(Sectors, Withdrawals)),\n#To put the columns side by side, we use the position_doge and width argument\n           width = 4, position = position_dodge(3.5)) +\n           scale_fill_manual(values = c(\"darkturquoise\", \"orange2\", \"red3\", \"dodgerblue3\", \"green4\")) +\n#We need a line a line plot to illustrate \"Total Freshwater Withdrawals in California from 2000-2015\"\n  geom_line(data = ca_wu_all, aes(x = Year, y = Withdrawals),\n            color = \"darkgray\", size = 1) +\n#We need a point plot to help emphasize the data points for total withdrawals for each year\n  geom_point(data = ca_wu_all, aes(x = Year, y = Withdrawals),\n            color = \"darkgrey\", size = 2, fill = \"darkgrey\") +\n  \n  scale_x_continuous(breaks = scales::pretty_breaks(n = 14),\n                     limits = c(1999, 2017),\n                    expand = c(0,0)) +\n  scale_y_continuous(breaks = scales::pretty_breaks(n = 10),\n                    limits = c(0, 20000),\n                    label = label_comma(),\n                    expand = c(0,0),\n                    sec.axis = sec_axis(trans = ~./1,\n                                breaks = breaks_pretty(n = 10),\n                                name = \"Total Withdrawals in CA (Mgal/day)\\n\",\n                                labels = label_comma())) +\n                                labs(x = \"Year\",\n                                y = \"Sector Withdrawals (Mgal/day)\",\n                                caption = \"Figure 1: GroundWater Withdrawals CA 2000-2015.\",\n                                fill = \"\") +\n#It adds a border to the around the plot and removes the grid in the background\n  theme_few() +\n  theme(axis.text = element_text(color = \"black\", size = 8),\n        axis.text.y.right = element_text(color = \"darkgrey\", size = 8),\n        axis.text.y = element_text(color = \"black\", size = 8),\n        axis.text.x = element_text(color = \"black\", size = 8),\n        axis.title.y.right = element_text(color = \"darkgrey\", size = 10),\n        axis.title.y.left = element_text(color = \"black\", size = 10),\n        axis.title.x = element_text(color = \"black\", size = 10),\n        legend.position = \"top\",\n        plot.caption = element_text(hjust = 0, face = \"bold\", size = 10))\n\n\n\n\n\nGiven the results of the plot, it seems that the agriculture sector is withdrawing massive amounts of water as groundwater levels keep decreasing."
  },
  {
    "objectID": "Scratch/groundwater_data/index.html#future-research",
    "href": "Scratch/groundwater_data/index.html#future-research",
    "title": "Where is California’s Groundwater Going?",
    "section": "Future Research",
    "text": "Future Research\nGiven the limitations of the datasets, it will be interesting to look at recently collected data within the recent 10 years to see if these trends are stil continuing. Groundwater is specially important in the state of California, so further research will help how use improve water management and distribution."
  }
]